<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªØ«Ø¨ÙŠØª Ù…ÙˆÙ‚Ø¹ ÙƒØªØ·Ø¨ÙŠÙ‚ iPhone - Ù†Ø³Ø®Ø© ØªØ­ÙƒÙ… Ù…Ø­Ø³Ù‘Ù†Ø©</title>
<style>
  body {
    font-family: 'Cairo', sans-serif;
    background: #f2f4f8;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100vh;
  }
  .card {
    background: #fff;
    padding: 25px;
    border-radius: 20px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    width: 90%;
    max-width: 420px;
    text-align: center;
  }
  h2 {
    color: #1f5fa6;
    margin-bottom: 10px;
  }
  input[type="text"], input[type="url"] {
    width: 100%;
    padding: 10px;
    margin: 8px 0;
    border: 1px solid #ddd;
    border-radius: 8px;
    text-align: left;
  }
  input[type="file"] { margin: 10px 0; }
  button {
    width: 100%;
    background: #1f5fa6;
    color: #fff;
    padding: 12px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
  }
  button:hover { background: #174b83; }
  footer {
    margin-top: 15px;
    color: #777;
    font-size: 13px;
  }
</style>
</head>
<body>
  <div class="card">
    <h2>ğŸ“² ØªØ«Ø¨ÙŠØª Ø£ÙŠ Ù…ÙˆÙ‚Ø¹ ÙƒØªØ·Ø¨ÙŠÙ‚ iPhone</h2>
    <input type="text" id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹" required>
    <input type="url" id="url" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙˆÙ‚Ø¹ https://" required>
    <input type="file" id="icon" accept="image/*">
    <button onclick="generate()">ğŸ“¥ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø§Ù„ØªØ«Ø¨ÙŠØª</button>
    <footer>Ø¨Ø±Ù…Ø¬Ø© Ø­Ø³ÙŠÙ† Ø§Ù„Ø¹Ø±ÙŠØ§Ù†ÙŠ ğŸ’¥</footer>
  </div>

  <script>
    async function generate() {
      const name = document.getElementById('name').value.trim();
      const url = document.getElementById('url').value.trim();
      const iconFile = document.getElementById('icon').files[0];

      if (!name || !url) {
        alert("âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„Ø±Ø§Ø¨Ø·.");
        return;
      }

      let iconData = "";
      if (iconFile) {
        const reader = new FileReader();
        iconData = await new Promise(res=>{
          reader.onload = ()=>res(reader.result.split(",")[1]);
          reader.readAsDataURL(iconFile);
        });
      }

      // âœ… ØµÙØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… HTML Ø­Ù‚ÙŠÙ‚ÙŠØ© ÙˆÙ„ÙŠØ³Øª ÙƒÙˆØ¯ Ù†ØµÙŠ
      const controlHTML = `
<!DOCTYPE html>
<html lang='ar' dir='rtl'>
<head>
<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0'>
<title>${name}</title>
<style>
  body,html{margin:0;padding:0;height:100%;overflow:hidden;font-family:sans-serif;}
  .bar{position:fixed;top:0;left:0;width:100%;height:45px;
    background:#1f5fa6;display:flex;align-items:center;
    justify-content:space-around;color:#fff;z-index:999;}
  .bar button{background:none;border:none;color:white;font-size:20px;cursor:pointer;}
  iframe{width:100%;height:100%;border:none;margin-top:45px;}
</style>
</head>
<body>
<div class='bar'>
  <button onclick='history.back()'>â¬…ï¸</button>
  <button onclick='document.getElementById("f").src=localStorage.getItem("main")'>ğŸ </button>
  <button onclick='document.getElementById("f").contentWindow.location.reload()'>ğŸ”„</button>
</div>
<iframe id='f'></iframe>
<script>
  const main = new URLSearchParams(location.search).get("url");
  localStorage.setItem("main", main);
  document.getElementById("f").src = main;
</script>
</body>
</html>`;

      // âœ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù HTML ÙØ¹Ù„ÙŠ
      const htmlBlob = new Blob([controlHTML], {type: "text/html;charset=utf-8"});
      const htmlURL = URL.createObjectURL(htmlBlob);
      const htmlLink = document.createElement("a");
      htmlLink.href = htmlURL;
      htmlLink.download = "control.html";
      htmlLink.click();

      // âœ… ØªÙˆÙ„ÙŠØ¯ Ù…Ù„Ù Ø§Ù„ØªØ«Ø¨ÙŠØª .mobileconfig
      const uuid = crypto.randomUUID();
      const plist = `<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
  <key>PayloadContent</key>
  <array>
    <dict>
      <key>FullScreen</key><true/>
      <key>Icon</key><data>${iconData}</data>
      <key>IsRemovable</key><true/>
      <key>Label</key><string>${name}</string>
      <key>PayloadDisplayName</key><string>${name}</string>
      <key>PayloadIdentifier</key><string>com.hussain.${uuid}</string>
      <key>PayloadOrganization</key><string>Ø¨Ø±Ù…Ø¬Ø© Ø­Ø³ÙŠÙ† Ø§Ù„Ø¹Ø±ÙŠØ§Ù†ÙŠ</string>
      <key>PayloadType</key><string>com.apple.webClip.managed</string>
      <key>PayloadUUID</key><string>${uuid}</string>
      <key>PayloadVersion</key><integer>1</integer>
      <key>Precomposed</key><true/>
      <key>URL</key><string>control.html?url=${encodeURIComponent(url)}</string>
    </dict>
  </array>
  <key>PayloadDisplayName</key><string>${name}</string>
  <key>PayloadIdentifier</key><string>appicon.${uuid}</string>
  <key>PayloadType</key><string>Configuration</string>
  <key>PayloadUUID</key><string>${uuid}</string>
  <key>PayloadVersion</key><integer>1</integer>
</dict>
</plist>`;

      const configBlob = new Blob([plist], { type: "application/x-apple-aspen-config;charset=utf-8" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(configBlob);
      link.download = `${name}.mobileconfig`;
      link.click();
    }
  </script>
</body>
      </html>
