<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>مولد Web Clip</title>
<style>
body {
  font-family: "Cairo", sans-serif;
  background: linear-gradient(135deg, #e3f2fd, #bbdefb);
  text-align: center;
  padding: 20px;
}
.container {
  background: white;
  border-radius: 15px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  padding: 20px;
  max-width: 400px;
  margin: auto;
}
input, select, button, textarea {
  width: 100%;
  padding: 10px;
  margin: 8px 0;
  border-radius: 10px;
  border: 1px solid #ccc;
  font-size: 16px;
  box-sizing: border-box;
}
button {
  background-color: #007bff;
  color: white;
  border: none;
  cursor: pointer;
}
button:hover {
  background-color: #0056b3;
}
textarea {
  height: 160px;
}
</style>
</head>
<body>

<h2>📱 مولد تطبيق ويب لآيفون</h2>
<p>أدخل بياناتك ثم اضغط "توليد ملف التعريف"</p>

<input type="text" id="appName" placeholder="اسم التطبيق">
<input type="url" id="appUrl" placeholder="رابط الموقع">
  <h5>اختر ايقونة التطبيق 📸</h5>
<input type="file" id="iconInput" accept="image/*">

<select id="modeSelect">
  <option value="mobile">📱 صفحة جوال</option>
  <option value="desktop">💻 صفحة كمبيوتر</option>
</select>

<br>
<img id="preview" style="display:none;"/><br>
<button onclick="generateProfile()">توليد ملف التعريف</button>

<p class="footer">برمجة حسين العرياني 💥</p>

<script>
function generateProfile() {
  const appName = document.getElementById("appName").value || "تطبيقي";
  const appUrl = document.getElementById("appUrl").value;
  const iconInput = document.getElementById("iconInput");
  const mode = document.getElementById("modeSelect").value;
  
  if (!appUrl) {
    alert("يرجى إدخال رابط الموقع أولاً");
    return;
  }

  const reader = new FileReader();
  reader.onload = function(e) {
    const iconBase64 = e.target.result.replace(/^data:image\/(png|jpeg);base64,/, '');
    const uuid = crypto.randomUUID();

    // تعديل إعدادات الشاشة حسب الاختيار
    const isFullScreen = mode === "mobile" ? "<true/>" : "<false/>";

    const profile = `<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
 <key>PayloadContent</key>
 <array>
  <dict>
   <key>FullScreen</key>${isFullScreen}
   <key>IgnoreManifestScope</key><true/>
   <key>Icon</key><data>${iconBase64}</data>
   <key>IsRemovable</key><true/>
   <key>Label</key><string>${appName}</string>
   <key>PayloadDescription</key><string>${appName}</string>
   <key>PayloadDisplayName</key><string>${appName}</string>
   <key>PayloadIdentifier</key><string>com.hussain.${uuid}</string>
   <key>PayloadOrganization</key><string>برمجة حسين العرياني</string>
   <key>PayloadType</key><string>com.apple.webClip.managed</string>
   <key>PayloadUUID</key><string>${uuid}</string>
   <key>PayloadVersion</key><integer>1</integer>
   <key>Precomposed</key><true/>
   <key>URL</key><string>${appUrl}</string>
  </dict>
 </array>
 <key>PayloadDescription</key><string>برمجة حسين العرياني</string>
 <key>PayloadDisplayName</key><string>${appName}</string>
 <key>PayloadIdentifier</key><string>profile.${uuid}</string>
 <key>PayloadType</key><string>Configuration</string>
 <key>PayloadUUID</key><string>${uuid}</string>
 <key>PayloadVersion</key><integer>1</integer>
</dict>
</plist>`;

    const blob = new Blob([profile], { type: "application/x-apple-aspen-config" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = appName + ".mobileconfig";
    link.click();
  };

  if (iconInput.files[0]) {
    reader.readAsDataURL(iconInput.files[0]);
  } else {
    reader.onload({ target: { result: "data:image/png;base64," } }); // بدون أيقونة
  }
}

document.getElementById("iconInput").addEventListener("change", e => {
  const file = e.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = ev => {
      const img = document.getElementById("preview");
      img.src = ev.target.result;
      img.style.display = "block";
    };
    reader.readAsDataURL(file);
  }
});
</script>

</body>
</html>
