<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>مولد تطبيق ويب لآيفون</title>
<style>
body {
  font-family: "Tajawal", sans-serif;
  direction: rtl;
  text-align: center;
  background: #f2f2f2;
  padding: 20px;
}
input, button {
  margin: 10px;
  padding: 10px;
  border-radius: 8px;
  border: 1px solid #ccc;
  width: 80%;
}
button {
  background: #007aff;
  color: white;
  border: none;
  cursor: pointer;
  font-size: 16px;
}
button:hover {
  background: #0059c1;
}
img {
  max-width: 100px;
  margin-top: 10px;
  border-radius: 20%;
  box-shadow: 0 0 5px #999;
}
.footer {
  margin-top: 40px;
  font-size: 16px;
  color: #444;
  font-weight: bold;
  animation: glow 1.5s ease-in-out infinite alternate;
}
@keyframes glow {
  from { color: #007aff; }
  to { color: #ff0080; }
}
</style>
</head>
<body>

<h2>📱 مولد تطبيق ويب لآيفون</h2>
<p>أدخل بياناتك ثم اضغط "توليد ملف التعريف"</p>

<input type="text" id="appName" placeholder="اسم التطبيق">
<input type="url" id="appUrl" placeholder="رابط الموقع">
<input type="file" id="iconInput" accept="image/*">
<br>
<img id="preview" style="display:none;"/><br>
<button onclick="generateProfile()">توليد ملف التعريف</button>

<p class="footer">برمجة حسين العرياني 💥</p>

<script>
function generateProfile() {
  const appName = document.getElementById("appName").value || "تطبيقي";
  const appUrl = document.getElementById("appUrl").value;
  const iconInput = document.getElementById("iconInput");
  
  if (!appUrl) {
    alert("يرجى إدخال رابط الموقع أولاً");
    return;
  }

  const reader = new FileReader();
  reader.onload = function(e) {
    const iconBase64 = e.target.result.replace(/^data:image\/(png|jpeg);base64,/, '');
    const uuid = crypto.randomUUID();
    
    const profile = `<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
 <key>PayloadContent</key>
 <array>
  <dict>
   <key>FullScreen</key><true/>
   <key>IgnoreManifestScope</key><true/>
   <key>Icon</key><data>${iconBase64}</data>
   <key>IsRemovable</key><true/>
   <key>Label</key><string>${appName}</string>
   <key>PayloadDescription</key><string>${appName}</string>
   <key>PayloadDisplayName</key><string>${appName}</string>
   <key>PayloadIdentifier</key><string>com.hussain.${uuid}</string>
   <key>PayloadOrganization</key><string>برمجة حسين العرياني</string>
   <key>PayloadType</key><string>com.apple.webClip.managed</string>
   <key>PayloadUUID</key><string>${uuid}</string>
   <key>PayloadVersion</key><integer>1</integer>
   <key>Precomposed</key><true/>
   <key>URL</key><string>${appUrl}</string>
  </dict>
 </array>
 <key>PayloadDescription</key><string>برمجة حسين العرياني</string>
 <key>PayloadDisplayName</key><string>${appName}</string>
 <key>PayloadIdentifier</key><string>profile.${uuid}</string>
 <key>PayloadType</key><string>Configuration</string>
 <key>PayloadUUID</key><string>${uuid}</string>
 <key>PayloadVersion</key><integer>1</integer>
</dict>
</plist>`;

    const blob = new Blob([profile], { type: "application/x-apple-aspen-config" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = appName + ".mobileconfig";
    link.click();
  };

  if (iconInput.files[0]) {
    reader.readAsDataURL(iconInput.files[0]);
  } else {
    reader.onload({ target: { result: "data:image/png;base64," } }); // بدون أيقونة
  }
}

document.getElementById("iconInput").addEventListener("change", e => {
  const file = e.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = ev => {
      const img = document.getElementById("preview");
      img.src = ev.target.result;
      img.style.display = "block";
    };
    reader.readAsDataURL(file);
  }
});
</script>

</body>
</html>
